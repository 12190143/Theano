\documentclass[utf8x,xcolor=pdftex,dvipsnames,table]{beamer}
\usetheme{Malmoe}  % Now it's a beamer presentation with the lisa theme!
\setbeamertemplate{footline}[page number]
\usecolortheme{beaver}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage[utf8x]{inputenc}
%\logo{\includegraphics[width=.8in]{UdeM_NoirBleu_logo_Marie_crop}}

\newcommand{\superscript}[1]{\ensuremath{^{\textrm{#1}}}}

\mode<presentation>

\title{Theano, Pylearn2, libgpuarray Presentation}

\author{
\footnotesize
Frédéric Bastien\superscript{a}, Bart van Merriënboer\superscript{a} \newline
\superscript{a}Département d'Informatique et de Recherche Opérationnelle \newline
Université de Montréal \newline
Montréal, Canada \newline
\texttt{\{bastienf, vanmerb\}@iro.umontreal.ca} \newline \newline
}

\date{OML Workshop 2014}

\setbeamertemplate{navigation symbols}{}

\begin{document}

\begin{frame}[plain]
 \titlepage
 \vspace{-5em}
 \includegraphics[width=1in]{../hpcs2011_tutorial/pics/lisabook_logo_text_3.png}
 \hfill
 \includegraphics[width=.8in]{../hpcs2011_tutorial/pics/UdeM_NoirBleu_logo_Marie_crop}
\end{frame}

\section{Introduction}
\begin{frame}{High level}\setcounter{page}{1}
  Python <- \{NumPy/SciPy/libgpuarray\} <- Theano <- Pylearn2
  \begin{itemize}
  \item Python: OO coding language
  \item Numpy: n-dimension array object and scientific computing toolbox
  \item SciPy: sparse matrix object and more scientific computing functionality
  \item libgpuarray: gpu n-dimentional array object in C for CUDA and OpenCL
  \item Theano: compiler/symbolic graph manipulation
  \item Pylearn2: machine learning framework
  \end{itemize}
\end{frame}

\begin{frame}{Python}
  \begin{itemize}
  \item General-purpose high-level OO interpreted language
  \item Emphasizes code readability
  \item Comprehensive standard library
  \item Dynamic type and memory management
  \item Slow execution
  \item Easily extensible from C
  \item Popular in *web-dev* and *scientific communities*
  \end{itemize}
\end{frame}

\begin{frame}{NumPy/SciPy}
  \begin{itemize}
  \item Python floats are full-fledged objects on the heap
      \begin{itemize}
      \item Not suitable for high-performance computing!
      \end{itemize}

  \item NumPy provides a N-dimensional numeric array in Python
      \begin{itemize}
      \item Perfect for high-performance computing.
      \item Slices of arrays are views (no copy)
      \end{itemize}

  \item NumPy provides
      \begin{itemize}
      \item Elementwise computations
      \item Linear algebra, Fourier transforms
      \item Pseudorandom numbers from many distributions
      \end{itemize}

  \item SciPy provides lots more, including
      \begin{itemize}
      \item Sparse matrix
      \item More linear algebra
      \item Solvers and optimization algorithms
      \item Matlab-compatible I/O
      \item I/O and signal processing for images and audio
      \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{What's missing?}
  \begin{itemize}
    \item Non-lazy evaluation (required by Python) hurts performance
    \item Bound to the CPU
    \item Lacks symbolic or automatic differentiation
    \item No automatic speed and stability optimization
  \end{itemize}

\end{frame}

\begin{frame}{Why scripting for GPUs?}
\begin{bf}They Complement each other\end{bf}

GPUs are everything that scripting/high level languages are not

    \begin{itemize}
    \item Highly parallel
    \item Very architecture-sensitive
    \item Built for maximum FP/memory throughput
    \item So hard to program that meta-programming is easier.
    \end{itemize}
\end{itemize}

\begin{bf}Best of both:\end{bf} easy scripted development invokes GPU kernel.

\begin{bf}Theano C code generation removes overhead\end{bf} from
function call between Python and C, by launching many C functions at once.

\end{frame}

\begin{frame}{Theano}


\end{frame}


\begin{frame}{Pylearn2}
\end{frame}
\begin{frame}{libgpuarray}
\end{frame}


\section{Theano}
\begin{frame}{Theano details}
\end{frame}
\begin{frame}{Project status?}
\end{frame}


\section{Pylearn2}
\begin{frame}{Pylearn2 details}
\end{frame}
\begin{frame}{Project status?}
\end{frame}

\section{libgpuarray}
\begin{frame}{libgpuarray details}
\end{frame}
\begin{frame}{Project status?}
\end{frame}

\section{sharing}
\begin{frame}{How can we do it?}
\end{frame}

\begin{frame}{OLD STUFF Why do we need this?}
\begin{itemize}
\item Efficient linear algebra is a the core of many scientific applications
\item On the CPU, numpy ndarray provides a standard object (for python at least)
\end{itemize}
\end{frame}

\begin{frame}{Why a new implementation?}
\begin{block}{There are already a number of existing GPU computing codebases:}
Theano, PyCUDA/PyOpenCL, CUDAmat, Gnumpy, Thrust, ...
\end {block}
\begin{enumerate}
\item<2-> All are incompatible, which hinders code sharing.
\item<3-> They do not support the full range of numpy ndarray features
\item<4-> None support both CUDA and OpenCL
\end{enumerate}
\end{frame}

\section{Features}

\begin{frame}{Strides}
\only<1>{Strides is a way to specify how much memory to skip between each element of a dimension.}
\only<2>{We can use strides to take submatrix ${\color{cyan!50}B}$ without copying any memory.}
\begin{center}
\onslide<1->{Matrix ${\color{red!50}A}$}\hspace{5em}\onslide<2->{Matrix ${\color{cyan!50}B}$}
\end{center}
\begin{center}
%%\only<1>{\includegraphics{strides-1}}
%%\only<2>{\includegraphics{strides-2}}
\end{center}
\end{frame}

\begin{frame}{Features desired}
\begin{itemize}
\item {\color{gray!80} Support for varying datatypes}
\item {\color{gray!80} Support for an arbitrary number of dimensions}
\item {\color{gray!80} Support for strides}
\item Support for broadcasting
\item {\color{gray!80} Compatibility with CUDA and OpenCL}
\end{itemize}
\end{frame}

\begin{frame}{Comparison of existing implementations}
\begin{table}
\rowcolors{2}{RoyalBlue!5}{RoyalBlue!23}
\begin{tabular}{|l|c|c|c|c|c|}
\hline
Package & strides & bcast & dims & types & backends \\
\hline
\hline
Theano & yes\footnote{as number of elements} & yes & any & float32 & CUDA \\
PyCUDA& no & no & any & all & CUDA \\
PyOpenCL & no & no & any & all & OpenCL \\
CUDAMat & no & yes\footnote{via a function} & 2 & float32 & CUDA \\
Gnumpy & no & yes & any & float32\footnote{and a hackish form of boolean} & CUDA \\
Thrust & no & no & 1 & all & CUDA \\
\hline
\hiderowcolors
Desired & yes & yes & any & all & both \\
\hline
\end{tabular}
\end{table}
\end{frame}


%%\vspace{-1em}

\section{Conclusion}
\begin{frame}{Future plans}
\begin{itemize}
\item<1-> Use in Theano/PyOpenCL/PyCUDA
\item<2-> Design and implement a good C/C++ interface
\item<3-> Find ways to lower the overhead
\item<4-> Use the implicit looping provided by CUDA and OpenCL
\item<5-> World domination!
\begin{itemize}
\item<6-> Library authors $\to$ come see us
\item<6-> Supervisers $\to$ talk to your students about this project
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{Acknowledgment}
\begin{itemize}
\item James Bergstra
\item Compute Canada, RQCHP, NSERC, and Canada Research Chairs for providing funds or access to compute resources.
\end{itemize}
\end{frame}

\begin{frame}
\begin{center}
\Huge
Questions?
\end{center}
\end{frame}


\end{document}
